!function(){function m(h,g){function b(p,q){return function(){return p.apply(q,arguments)}}var j;if(g=g||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=g.touchBoundary||10,this.layer=h,this.tapDelay=g.tapDelay||200,this.tapTimeout=g.tapTimeout||700,!m.notNeeded(h)){for(var f=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],d=this,o=0,c=f.length;c>o;o++){d[f[o]]=b(d[f[o]],d)}e&&(h.addEventListener("mouseover",this.onMouse,!0),h.addEventListener("mousedown",this.onMouse,!0),h.addEventListener("mouseup",this.onMouse,!0)),h.addEventListener("click",this.onClick,!0),h.addEventListener("touchstart",this.onTouchStart,!1),h.addEventListener("touchmove",this.onTouchMove,!1),h.addEventListener("touchend",this.onTouchEnd,!1),h.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(h.removeEventListener=function(u,q,t){var p=Node.prototype.removeEventListener;"click"===u?p.call(h,u,q.hijacked||q,t):p.call(h,u,q,t)},h.addEventListener=function(u,q,t){var p=Node.prototype.addEventListener;"click"===u?p.call(h,u,q.hijacked||(q.hijacked=function(r){r.propagationStopped||q(r)}),t):p.call(h,u,q,t)}),"function"==typeof h.onclick&&(j=h.onclick,h.addEventListener("click",function(p){j(p)},!1),h.onclick=null)}}var k=navigator.userAgent.indexOf("Windows Phone")>=0,e=navigator.userAgent.indexOf("Android")>0&&!k,i=/iP(ad|hone|od)/.test(navigator.userAgent)&&!k,n=i&&/OS 4_\d(_\d)?/.test(navigator.userAgent),l=i&&/OS [6-7]_\d/.test(navigator.userAgent),a=navigator.userAgent.indexOf("BB10")>0;m.prototype.needsClick=function(b){switch(b.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(b.disabled){return !0}break;case"input":if(i&&"file"===b.type||b.disabled){return !0}break;case"label":case"iframe":case"video":return !0}return/\bneedsclick\b/.test(b.className)},m.prototype.needsFocus=function(b){switch(b.nodeName.toLowerCase()){case"textarea":return !0;case"select":return !e;case"input":switch(b.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return !1}return !b.disabled&&!b.readOnly;default:return/\bneedsfocus\b/.test(b.className)}},m.prototype.sendClick=function(c,f){var b,d;document.activeElement&&document.activeElement!==c&&document.activeElement.blur(),d=f.changedTouches[0],b=document.createEvent("MouseEvents"),b.initMouseEvent(this.determineEventType(c),!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),b.forwardedTouchEvent=!0,c.dispatchEvent(b)},m.prototype.determineEventType=function(b){return e&&"select"===b.tagName.toLowerCase()?"mousedown":"click"},m.prototype.focus=function(b){var c;i&&b.setSelectionRange&&0!==b.type.indexOf("date")&&"time"!==b.type&&"month"!==b.type?(c=b.value.length,b.setSelectionRange(c,c)):b.focus()},m.prototype.updateScrollParent=function(b){var d,c;if(d=b.fastClickScrollParent,!d||!d.contains(b)){c=b;do{if(c.scrollHeight>c.offsetHeight){d=c,b.fastClickScrollParent=c;break}c=c.parentElement}while(c)}d&&(d.fastClickLastScrollTop=d.scrollTop)},m.prototype.getTargetElementFromEventTarget=function(b){return b.nodeType===Node.TEXT_NODE?b.parentNode:b},m.prototype.onTouchStart=function(c){var d,b,f;if(c.targetTouches.length>1){return !0}if(d=this.getTargetElementFromEventTarget(c.target),b=c.targetTouches[0],i){if(f=window.getSelection(),f.rangeCount&&!f.isCollapsed){return !0}if(!n){if(b.identifier&&b.identifier===this.lastTouchIdentifier){return c.preventDefault(),!1}this.lastTouchIdentifier=b.identifier,this.updateScrollParent(d)}}return this.trackingClick=!0,this.trackingClickStart=c.timeStamp,this.targetElement=d,this.touchStartX=b.pageX,this.touchStartY=b.pageY,c.timeStamp-this.lastClickTime<this.tapDelay&&c.preventDefault(),!0},m.prototype.touchHasMoved=function(b){var d=b.changedTouches[0],c=this.touchBoundary;return Math.abs(d.pageX-this.touchStartX)>c||Math.abs(d.pageY-this.touchStartY)>c?!0:!1},m.prototype.onTouchMove=function(b){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(b.target)||this.touchHasMoved(b))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},m.prototype.findControl=function(b){return void 0!==b.control?b.control:b.htmlFor?document.getElementById(b.htmlFor):b.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},m.prototype.onTouchEnd=function(j){var g,c,f,h,b,d=this.targetElement;if(!this.trackingClick){return !0}if(j.timeStamp-this.lastClickTime<this.tapDelay){return this.cancelNextClick=!0,!0}if(j.timeStamp-this.trackingClickStart>this.tapTimeout){return !0}if(this.cancelNextClick=!1,this.lastClickTime=j.timeStamp,c=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,l&&(b=j.changedTouches[0],d=document.elementFromPoint(b.pageX-window.pageXOffset,b.pageY-window.pageYOffset)||d,d.fastClickScrollParent=this.targetElement.fastClickScrollParent),f=d.tagName.toLowerCase(),"label"===f){if(g=this.findControl(d)){if(this.focus(d),e){return !1}d=g}}else{if(this.needsFocus(d)){return j.timeStamp-c>100||i&&window.top!==window&&"input"===f?(this.targetElement=null,!1):(this.focus(d),this.sendClick(d,j),i&&"select"===f||(this.targetElement=null,j.preventDefault()),!1)}}return i&&!n&&(h=d.fastClickScrollParent,h&&h.fastClickLastScrollTop!==h.scrollTop)?!0:(this.needsClick(d)||(j.preventDefault(),this.sendClick(d,j)),!1)},m.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},m.prototype.onMouse=function(b){return this.targetElement?b.forwardedTouchEvent?!0:b.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(b.stopImmediatePropagation?b.stopImmediatePropagation():b.propagationStopped=!0,b.stopPropagation(),b.preventDefault(),!1):!0:!0},m.prototype.onClick=function(b){var c;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===b.target.type&&0===b.detail?!0:(c=this.onMouse(b),c||(this.targetElement=null),c)},m.prototype.destroy=function(){var b=this.layer;e&&(b.removeEventListener("mouseover",this.onMouse,!0),b.removeEventListener("mousedown",this.onMouse,!0),b.removeEventListener("mouseup",this.onMouse,!0)),b.removeEventListener("click",this.onClick,!0),b.removeEventListener("touchstart",this.onTouchStart,!1),b.removeEventListener("touchmove",this.onTouchMove,!1),b.removeEventListener("touchend",this.onTouchEnd,!1),b.removeEventListener("touchcancel",this.onTouchCancel,!1)},m.notNeeded=function(f){var b,g,d,c;if("undefined"==typeof window.ontouchstart){return !0}if(g=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!e){return !0}if(b=document.querySelector("meta[name=viewport]")){if(-1!==b.content.indexOf("user-scalable=no")){return !0}if(g>31&&document.documentElement.scrollWidth<=window.outerWidth){return !0}}}if(a&&(d=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),d[1]>=10&&d[2]>=3&&(b=document.querySelector("meta[name=viewport]")))){if(-1!==b.content.indexOf("user-scalable=no")){return !0}if(document.documentElement.scrollWidth<=window.outerWidth){return !0}}return"none"===f.style.msTouchAction||"manipulation"===f.style.touchAction?!0:(c=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],c>=27&&(b=document.querySelector("meta[name=viewport]"),b&&(-1!==b.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))?!0:"none"===f.style.touchAction||"manipulation"===f.style.touchAction?!0:!1)},m.attach=function(b,c){return new m(b,c)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return m}):"undefined"!=typeof module&&module.exports?(module.exports=m.attach,module.exports.FastClick=m):window.FastClick=m}();$(function(){FastClick.attach(document.body)});(function(){var b={_options:{sel:".page-content",slideWidth:320,slideHeight:504,fixMode:"auto"},_curRatio:1,_docWidth:0,_docHeight:0,_calcScaleRatio:function(){this._docWidth=document.documentElement.clientWidth,this._docHeight=document.documentElement.clientHeight;var a={width:this._docWidth/this._options.slideWidth,height:this._docHeight/this._options.slideHeight};this._curRatio=a[this._options.fixMode]?a[this._options.fixMode]:a.width>a.height?a.height:a.width;return this},_fixEl:function(){var a=this._curRatio;$(this._options.sel).attr("style","-webkit-transform:scale("+a+","+a+");-webkit-transition:all 0.5s;");return this},fitWindow:function(){return this._calcScaleRatio()._fixEl()},bindResize:function(){var a=0,d=this;$(window).bind("resize",function(){a&&clearTimeout(a);setTimeout(function(){d.fitWindow()},1000)});return this}};$(function(){b.bindResize();b.fitWindow()})}());var load=document.getElementById("loading");var pw=parseInt($("#pro_div .pro_bg").css("width"));var imgSources=["icon_loading.gif","bg_startPage.jpg","top.png","zp.png","chuan.png","btn_start.png","icon_rule.png","p1.png","p2.png","yun1.png","yun2.png","yun3.png","bg_maps.jpg","yu1.png","yu2.png","yu3.png","line1.png","line2.png","line3.png","quit_game.png","guanka_chuan.png","guanka_dt.png","guanka_zp.png","arrow_txt1.png","arrow_txt2.png","arrow_txt3.png","chuan_top.png","dt_top.png","zp_top.png","btn_rotate.png","icon_pass.png","dati_suc.png","dati_err.png","btn_continue.png","ly_plate.png","bg_dati.png","btn_downMhd.png","icon_weibo.png","icon_qqzone.png","icon_weixin.png","icon_pity.png","icon_wining.png","btn_close.png","arr.png"];var nowload=0;var imgVal=imgSources.length;var imgPath="content/img/";var loadingPage=(function(){for(var l=0;l<imgSources.length;l++){imgSources[l]=(imgPath+imgSources[l])}var i=function(b,a){var c=new Image();c.onload=function(){c.onload=null;a(b);nowload++;$("#pro_div .pro").css("width",pw/imgVal*nowload)};c.src=b};var h=function(a,b){var d=a.length,c=0;while(a.length){i(a.shift(),function(e){b(e,++c,d)})}};var g=document.getElementById("loading_rate");var j=document.getElementById("bar");var k=0;h(imgSources,function(b,a,c){k=a/c;g.innerHTML=Math.floor(k*100)+"%";if(k==1){setTimeout(function(){$("#loading").css("display","none");initPage01()},500)}})})();function initPage01(){$("#page-start").css("display","block").addClass("active");$("#startgame").click(function(){$("#page-start").css("display","none").removeClass("active");$.LAYER.show({id:"pop-box11",layerContainer:"mark",overlay:{color:"#000",opacity:0.5}});initPage02()})}function initPage02(){var b=0;$("#page-maps").css("display","block").addClass("active");$(".guanka_chuan").one("webkitAnimationEnd",function(){$(".guanka_chuan").addClass("on")});$(document.body).delegate(".guanka_chuan","click",function(){if($(this).hasClass("off")){return false}$("#page-level-1").css("display","block").addClass("active");$("#page-level-1 .item").addClass("on");$("#page-level-1 .item li").removeClass("active");$("#page-level-1 .item li").click(function(){$(this).addClass("active");$("#page-level-1 .item li").off("click");if($(this).children("div.tit").children("span").hasClass("dati_suc")){$(this).parents().siblings(".pass").addClass("active");$(this).parents().siblings(".btn_continue").addClass("show");b++}else{$.LAYER.show({id:"pop-box5",layerContainer:"mark",overlay:{color:"#000",opacity:0.5}});var a=$(this);$(".btn-close").click(function(){console.log(a);a.parents(".page-level").css("display","none").removeClass("active")})}});$("#page-level-1 .btn_continue").click(function(){$(this).parent(".page-level").css("display","none").removeClass("active");$(".guanka_chuan").removeClass("on").addClass("off");$(".guanka_dt").addClass("on")})});$(document.body).delegate(".guanka_dt","click",function(){if($(this).hasClass("off")){return false}$("#page-level-2").css("display","block").addClass("active");$("#page-level-2 .item").addClass("on");$("#page-level-2 .item li").removeClass("active");$("#page-level-2 .item li").click(function(){$(this).addClass("active");$("#page-level-2 .item li").off("click");if($(this).children("div.tit").children("span").hasClass("dati_suc")){$(this).parents().siblings(".pass").addClass("active");$(this).parents().siblings(".btn_continue").addClass("show");b++}else{$.LAYER.show({id:"pop-box5",layerContainer:"mark",overlay:{color:"#000",opacity:0.5}});var a=$(this);$(".btn-close").click(function(){a.parents(".page-level").css("display","none").removeClass("active")})}});$("#page-level-2 .btn_continue").click(function(){$(this).parent(".page-level").css("display","none").removeClass("active");$(".guanka_dt").removeClass("on").addClass("off");$(".guanka_zp").addClass("on")})});$(document.body).delegate(".guanka_zp","click",function(){if(b===2){$("#page-level-3").css("display","block").addClass("active")}else{$.LAYER.show({id:"pop-box3",layerContainer:"mark",overlay:{color:"#000",opacity:0.5}})}})}$(".btn-return").click(function(){$(this).parent(".page-level").css("display","none").removeClass("active")});$(".btn-close").click(function(){$.LAYER.close()});$("#quitgame").click(function(){$.LAYER.show({id:"pop-box9",layerContainer:"mark",overlay:{color:"#000",opacity:0.5}})});$(function(){var d=function(){$("#lotteryImg").rotate({angle:0,duration:10000,animateTo:2188,callback:function(){alert("网络超时")}})};var c=function(f,a,b){$("#lotteryImg").stopRotate();$("#lotteryImg").rotate({angle:0,duration:5000,animateTo:a+1440,callback:function(){alert(b)}})};$("#lottery_star div").rotate({bind:{click:function(){var b=[0,1];b=b[Math.floor(Math.random()*b.length)];if(b==0){d()}if(b==1){var f=[1,2,3,0];f=f[Math.floor(Math.random()*f.length)];if(f==1){c(1,60,"恭喜您抽中的一等奖")}if(f==2){c(2,120,"恭喜您抽中的二等奖")}if(f==3){c(3,180,"恭喜您抽中的三等奖")}if(f==0){var a=[240,300];a=a[Math.floor(Math.random()*a.length)];c(0,a,"很遗憾，这次您未抽中奖")}}}}})});function browserRedirect(){var p=navigator.userAgent.toLowerCase();var l=p.match(/ipad/i)=="ipad";var k=p.match(/iphone os/i)=="iphone os";var m=p.match(/midp/i)=="midp";var o=p.match(/rv:1.2.3.4/i)=="rv:1.2.3.4";var n=p.match(/ucweb/i)=="ucweb";var r=p.match(/android/i)=="android";var q=p.match(/windows ce/i)=="windows ce";var j=p.match(/windows mobile/i)=="windows mobile";if(o||n||r||q||j){return"android"}else{if(k||l){return"ios"}else{return"pc"}}}$(function(){$("#share-frends").click(function(){if(browserRedirect()=="android"){$("#mark_android").show()}if(browserRedirect()=="ios"){$("#mark_ios").show()}})});